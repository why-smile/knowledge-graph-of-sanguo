# 基于百科数据的三国时期历史人物知识图谱的构建
## 项目内容  
本项目所有代码均位于本库的mater分支中的src文件夹中，所有数据文件均位于本库的master分支中的data文件夹中。  
项目步骤如下：
*知识初步提取
1. 初步提取人物信息，详细代码见**网址信息-人名.py**，代码思路如下：  
从百度百科中通过python爬虫工具从[“三国”](https://baike.baidu.com/item/%E4%B8%89%E5%9B%BD/5428)首先爬取了数百个三国时期的人物，为了清除掉从网页提取出的超链接中非人物的部分，引入比对外部文件**三国人物.txt**，然后对提取到的网址进行规范化处理，即网址均以人物名称加数字后缀结尾，后以人物名称-网址的格式进行输出，最后输出到**网址信息-人物名称.txt**文档中。
2. 通过每个人物的关系栏补充与该人物主体有关系的同属于三国时期的人物，详细代码见**关系人物-关系人物网址信息.py**，代码思路如下：  
通过每个人物的信息框提取与该人物有关的三国时期人物信息，之前输出方式一致，最后输出到**关系人物名称-关系人物未去重.txt**文档中。
3. 将得到的关系人物的网址进行规范化处理，详细代码见**规范化网址.py**，代码思路如下：  
导入上一步得到的文档，对关系人物的网址进行规范化处理，同时限制关系人物的出生日期在1000年以后，最后过滤后将得到的关系任务进行输出，输出到**规范化关系人物网址.txt**文档中。
4. 将关系人物与之前得到的人物合并，详细代码见**合并网址.py**，代码思路如下：  
将上一步得到的文档导入代码内，将新得到的关系人物加入之前的**网址信息-人物名称.txt**文档中。
5. 将所有人物以网址为基准进行去重处理，详细代码见**人物网址去重.py**，代码思路如下：  
以网址为基准去掉重复的人物，最后将去重后的人物输出到文档**去重最终版网址信息-人物名称.txt**中。
6. 得到人物的属性及人物的关系文档，详细代码分别见**姓名-网址-key-value.py**及**人名-关系-人名.py**，代码思路分别如下：  
   * 对于人物属性的提取，通过提取每个人物百科页面的信息框提取出每个人物的属性三元组信息并对将属性值放入列表中以json格式进行输出，最后以网址-名称-key-value四元组格式输出到文档**网址-名称-key-value.txt**中。
   * 对于人物的关系提取，首先前提是关系人物必须是与该人物有关系的同属于三国时期的人物且该人物在之前构建的人物集合中，最后以人名-关系-人名的格式输出到文档**网址-关系-网址.txt**中。
7. 初步提取著作实体，详细代码见**初步著作名称-著作网址.py**，代码思路如下：  
将**去重最终版网址信息-人物名称.txt**文档导入，然后对每个人物的著作属性提取带有超链接的属性值及链接，最后以人物名称-人物网址-著作名称-著作网址的格式输出到**人物名称-人物网址-著作名称-著作网址.txt**文档中。
8. 规范著作网址，详细代码见**著作网址规范.py**，代码思路如下：  
将著作网址以与人物网址相同的格式规范进行规范后将人物与著作的三元组关系以人物网址-著作-著作网址的格式输出到文档**人物网址-著作-著作网址.txt**中。
9. 提取著作的属性值三元组，详细代码见**著作名称-著作网址-key-value.py**，代码思路如下：  
与提取人物属性规则相同，提取著作属性值三元组，并将三元组以著作名称-著作网址-key-value的四元组格式输出到文档**著作名称-著作网址-key-value.txt**中。
*知识图谱的可视化展示
* jsonld的schema展示
1. 判断属性值是str还是list类型，详细代码见**导出excel表.py**，代码思路如下：  
导入**著作名称-著作网址-key-value.txt**和**网址-名称-key-value.txt**两文档，判断属性值列表长度是否为1，若为1，则为str类型，若大于1，则为list类型，最后以属性名称-属性类型-范例-类型的格式输出到文档**表单.xls**中，并将人物与著作的关系三元组和属性四元组复制进**表单.xls**文档中。
2. 将人物实体与著作实体以jsonld的格式输出，详细代码见**导出jsonld.py**，代码思路如下：  
导入**表单.xls**，人物实体的jsonld里需要有关系和属性两种，而著作实体只需要有属性，而且每个实体必须以@type和@id标识，其中人物的@type为人物，著作的@type为著作，@id统一为实体的网址，最后输出到文档**jsonld.txt**文档中。
* 图数据库展示的预处理  
由于图数据库属性输入的需要，因此对需要对属性值部分数据进行处理，详细代码见**用于hugegraph格式的人物处理.py**及**用于hugegraph格式的著作处理.py**，最后分别得到**网址-名称-key-value.csv**和**著作名称-著作网址-key-value.csv**两个文档。同时将关系三元组导入另外两csv表格分别为**人物-关系-人物.csv**及**人物-著作-著作名称.csv**中。
## 项目要求
1. 从百科类网络资源抓取三国人物属性和人物关系，进行数据的清洗、schema的定义、属性的补充以及人物知识图谱的构建。  
要求包含作品实体和人物实体，人物数量>=100，人物属性数量>=5，人物关系的类型>=10。
2. 使用图数据库存储知识图谱，能使用gremlin语句进行基本的知识查询，如“魏国的名将有哪些？”，“《观沧海》的作者是谁？”

